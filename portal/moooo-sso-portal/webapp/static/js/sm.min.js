function leftPad(r,t){var n=r.length;return Array(t>n?t-n+1:0).join(0)+r}function binary2hex(r){for(var t=8,n="",e=0;e<r.length/t;e+=1)n+=leftPad(parseInt(r.substr(e*t,t),2).toString(16),2);return n}function hex2binary(r){for(var t=2,n="",e=0;e<r.length/t;e+=1)n+=leftPad(parseInt(r.substr(e*t,t),16).toString(2),8);return n}function str2binary(r){var t="",n=!0,e=!1,o=void 0;try{for(var a,i=r[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var u=a.value;t+=leftPad(u.codePointAt(0).toString(2),8)}}catch(b){e=!0,o=b}finally{try{!n&&i.return&&i.return()}finally{if(e)throw o}}return t}function rol(r,t){return r.substring(t%r.length)+r.substr(0,t%r.length)}function binaryCal(r,t,n){for(var e=r||"",o=t||"",a=[],i=void 0,u=e.length-1;u>=0;u-=1)i=n(e[u],o[u],i),a[u]=i[0];return a.join("")}function xor(r,t){return binaryCal(r,t,function(r,t){return[r===t?"0":"1"]})}function and(r,t){return binaryCal(r,t,function(r,t){return["1"===r&&"1"===t?"1":"0"]})}function or(r,t){return binaryCal(r,t,function(r,t){return["1"===r||"1"===t?"1":"0"]})}function add(r,t){var n=binaryCal(r,t,function(r,t,n){var e=n?n[1]:"0";return r!==t?["0"===e?"1":"0",e]:[e,r]});return n}function not(r){return binaryCal(r,void 0,function(r){return["1"===r?"0":"1"]})}function calMulti(r){return function(){for(var t=arguments.length,n=Array(t),e=0;t>e;e++)n[e]=arguments[e];return n.reduce(function(t,n){return r(t,n)})}}function P0(r){return calMulti(xor)(r,rol(r,9),rol(r,17))}function P1(r){return calMulti(xor)(r,rol(r,15),rol(r,23))}function FF(r,t,n,e){return e>=0&&15>=e?calMulti(xor)(r,t,n):calMulti(or)(and(r,t),and(r,n),and(t,n))}function GG(r,t,n,e){return e>=0&&15>=e?calMulti(xor)(r,t,n):or(and(r,t),and(not(r),n))}function T(r){return hex2binary(r>=0&&15>=r?"79cc4519":"7a879d8a")}function CF(r,t){for(var n=32,e=[],o=[],a=0;16>a;a+=1)e.push(t.substr(a*n,n));for(var i=16;68>i;i+=1)e.push(calMulti(xor)(P1(calMulti(xor)(e[i-16],e[i-9],rol(e[i-3],15))),rol(e[i-13],7),e[i-6]));for(var u=0;64>u;u+=1)o.push(xor(e[u],e[u+4]));for(var b=[],l=0;8>l;l+=1)b.push(r.substr(l*n,n));for(var f=b[0],s=b[1],c=b[2],g=b[3],x=b[4],d=b[5],h=b[6],y=b[7],v=void 0,S=void 0,A=void 0,p=void 0,w=0;64>w;w+=1)v=rol(calMulti(add)(rol(f,12),x,rol(T(w),w)),7),S=xor(v,rol(f,12)),A=calMulti(add)(FF(f,s,c,w),g,S,o[w]),p=calMulti(add)(GG(x,d,h,w),y,v,e[w]),g=c,c=rol(s,9),s=f,f=A,y=h,h=rol(d,19),d=x,x=P0(p);return xor(Array(f,s,c,g,x,d,h,y).join(""),r)}function sm3(r){var t=str2binary(r),n=t.length,e=n%512;e=e>=448?512-e%448-1:448-e-1;for(var o=(t+"1"+leftPad("",e)+leftPad(n.toString(2),64)).toString(),a=(n+e+65)/512,i=hex2binary("7380166f4914b2b9172442d7da8a0600a96f30bc163138aae38dee4db0fb0e4e"),u=0;a-1>=u;u+=1){var b=o.substr(512*u,512);i=CF(i,b)}return binary2hex(i)}function bigxor(r,t){return r^t}function leftshift(r,t,n){return n=n?n:32,t%=n,r<<t|r>>>n-t}function prefixInteger(r,t){return Array(t+1).join("0").split("").concat(String(r).split("")).slice(-t).join("")}function sm4Sbox(r){var t=SboxTable[(4026531840&r)>>>28][(251658240&r)>>>24],n=SboxTable[(15728640&r)>>>20][(983040&r)>>>16],e=SboxTable[(61440&r)>>>12][(3840&r)>>>8],o=SboxTable[(240&r)>>>4][(15&r)>>>0];return t<<24|n<<16|e<<8|o<<0}function GET_ULONG_BE(r){return r=sm4Sbox(r),bigxor(bigxor(bigxor(r,leftshift(r,2)),bigxor(leftshift(r,10),leftshift(r,18))),leftshift(r,24))}function PUT_ULONG_BE(r){return r=sm4Sbox(r),bigxor(r,bigxor(leftshift(r,13),leftshift(r,23)))}function sm4_getkey(r){var t=new Array,n=new Array;t[0]=bigxor(r[0],FK[0]),t[1]=bigxor(r[1],FK[1]),t[2]=bigxor(r[2],FK[2]),t[3]=bigxor(r[3],FK[3]);for(var e=0;32>e;e++)t[e+4]=bigxor(t[e],PUT_ULONG_BE(bigxor(bigxor(t[e+1],t[e+2]),bigxor(t[e+3],CK[e])))),n[e]=t[e+4].toString(16);return n}function KJUR_encrypt_sm4(r,t,n){n=n?n:"cbc";for(var e=t,o=r,a=sm4_getkey(e),i=0;32>i;i++)o[i+4]=bigxor(o[i],GET_ULONG_BE(bigxor(bigxor(o[i+1],o[i+2]),bigxor(o[i+3],parseInt(a[i],16)))));var u=new Array(o[35].toString(16),o[34].toString(16),o[33].toString(16),o[32].toString(16));return u}function KJUR_decrypt_sm4(r,t,n){n=n?n:"cbc";for(var e=t,o=r,a=sm4_getkey(e),i=new Array,u=a.length-1;u>=0;u--)i[a.length-1-u]=a[u];for(var u=0;32>u;u++)o[u+4]=bigxor(o[u],GET_ULONG_BE(bigxor(bigxor(o[u+1],o[u+2]),bigxor(o[u+3],parseInt(i[u],16)))));var b=new Array(o[35].toString(16),o[34].toString(16),o[33].toString(16),o[32].toString(16));return b}function strToHexCharCode(r,t){if(""===r)return"";for(var n=[],e=0;e<r.length;e++){var o=r.charCodeAt(e).toString(16);o.length<2&&(o="0"+o),n.push(o)}return t?n.join(""):"0x"+n.join("")}function hexCharCodeToStr(r){var t=r.trim(),n="0x"===t.substr(0,2).toLowerCase()?t.substr(2):t,e=n.length;if(e%2!==0)return alert("Illegal Format ASCII Code!"),"";for(var o,a=[],i=0;e>i;i+=2)o=parseInt(n.substr(i,2),16),a.push(String.fromCharCode(o));return a.join("")}function sm4_encrypt_ecb(r,t){if(r.length>16||r.length<=0)return!1;r=strAddZero(r);var n=strTo16Array(r),e=H16ToArray(t),o=KJUR_encrypt_sm4(n,e),a=ciphertextToInt(o);return{res_ciphertext:a.join(""),ciphertext:o.join(",")}}function H16ToArray(r){for(var t=[],n=0;4>n;n++)t.push("0x"+r.substring(8*n,8*(n+1)));return t}function strAddZero(r){for(;r.length<16;)r+=hexCharCodeToStr("00");return r}function strTo16Array(r,t){t||(t=!1);for(var n=[],e=0;4>e;e++)n.push(strToHexCharCode(r.substring(4*e,4*(e+1)),t).toString(16));return n}function ciphertextToInt(r){for(var t=[],n=0;n<r.length;n++)if("-"==r[n].substring(0,1)){var e="0x"+r[n].substring(1),o=(4294967295-e+1).toString(16);t.push(h16AddZero(o))}else t.push(h16AddZero(r[n]));return t}function h16AddZero(r){for(;r.length<8;)r="0"+r;return r}function sm4_decrypt_ecb(r,t){t=strAddZero(t);for(var n=strTo16Array(t,!0),e=0;e<r.length;e++)r[e]=parseInt(r[e],16);for(var e=0;e<n.length;e++)n[e]=parseInt(n[e],16);var o=KJUR_decrypt_sm4(r,n),a=ciphertextToInt(o);return hexCharCodeToStr(a.join(""))}function sm3_encrypt(r){return sm3(r).toUpperCase()}function sm3_byte(r){var t=r.length,n=t%512;n=n>=448?512-n%448-1:448-n-1;for(var e=(r+"1"+leftPad("",n)+leftPad(t.toString(2),64)).toString(),o=(t+n+65)/512,a=hex2binary("7380166f4914b2b9172442d7da8a0600a96f30bc163138aae38dee4db0fb0e4e"),i=0;o-1>=i;i+=1){var u=e.substr(512*i,512);a=CF(a,u)}return binary2hex(a)}function toTwoHex(r){for(var t="",n=0;n<r.length;n+=2)t+=addBriZero(parseInt(r.substring(n,n+2),16).toString(2));return t}function addBriZero(r){for(;r.length<8;)r="0"+r;return r}function addH16ZeroTwo(r){return r.length<2&&(r="0"+r),r}var SboxTable=new Array;SboxTable[0]=new Array(214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5),SboxTable[1]=new Array(43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153),SboxTable[2]=new Array(156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98),SboxTable[3]=new Array(228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166),SboxTable[4]=new Array(71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168),SboxTable[5]=new Array(104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53),SboxTable[6]=new Array(30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135),SboxTable[7]=new Array(212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158),SboxTable[8]=new Array(234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161),SboxTable[9]=new Array(224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227),SboxTable[10]=new Array(29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111),SboxTable[11]=new Array(213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81),SboxTable[12]=new Array(141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216),SboxTable[13]=new Array(10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176),SboxTable[14]=new Array(137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132),SboxTable[15]=new Array(24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72);var CK=new Array(462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257),FK=new Array(2746333894,1453994832,1736282519,2993693404);